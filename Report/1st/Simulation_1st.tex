\documentclass[10pt,titlepage]{jsarticle}
\usepackage{listings}
\usepackage{jlisting}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{ascmac}
\usepackage[dvipdfmx]{graphicx}
\usepackage{array}
\usepackage{float}
\usepackage{moreverb}
\usepackage{framed}

\renewcommand{\lstlistingname}{ソースコード}
\lstset{
  language=c,
  basicstyle=\ttfamily\scriptsize,
  commentstyle=\textit,
  classoffset=1,
  keywordstyle=\bfseries,
  frame=tRBl,
  framesep=5pt,
  showstringspaces=false,
  numbers=left,
  stepnumber=1,
  numberstyle=\tiny,
  tabsize=2,
  breaklines=true
}
\setcounter{page}{1}

\title{シミュレーション}
\author{4年電子情報工学科\\34番 横前洸佑}
\date{提出日：2019/12/12（木）\\	提出期限：2019/12/12（木）17:00}
\begin{document}

\maketitle

\section{課題1}
\label{sec:kadai1}
課題\ref{sec:kadai1}では、台形公式、式(\ref{eq:daikei})を用いて式(\ref{kadai1})について数値積分を行う。さらに、台形公式を使用する際に分割数を1,2,4,...のように1/2ずつ細かくしていき、台形公式で求めた積分値の結果と解析解との関係を報告する。


\begin{equation}
\label{eq:daikei}
	\int_a^b f(x) dx \approx \frac{h}{2}\left[y_0+2 \sum_{j=1}^{n-1}y_j+y_n\right]
\end{equation}


\begin{equation}
\label{kadai1}
	\int_0^\frac{\pi}{6} \frac{dx}{\cos x}
\end{equation}

\subsection{作成したプログラム}
今回作成したプログラムをソースコード\ref{prog1}に示す。

\lstinputlisting[caption=課題1のプログラム,label=prog1]{src/kadai1.c}

%%%%%%%%%%%%%%プログラムの説明
このプログラムでは、分割数Nを1から512まで計算している。
そして、計算結果と式\ref{kadai1}の解析解の$\frac{1}{2}\log_e3=0.549306144$との差を表示する。なお、積分される関数及び台形公式の計算部分は使いやすくするためにそれぞれ個別の関数にしている。

\subsection{プログラムの実行結果}
実行結果を以下に示す。
\begin{oframed}
\verbatimtabinput[2]{result/kadai1.txt}
\end{oframed}

実行結果より、分割数Nが1/2になるごとに計算誤差が1/4ずつ減っていることがわかる。

\subsection{考察}


\section{課題2}
課題2では、シンプソンの公式を用いて式\ref{kadai2}について数値積分を行う。さらに{\tt float}型と{\tt double}型で実行し、丸め誤差が現れる刻み幅を調べる。また、刻み幅を1/2にした時の誤差の減り方について報告する。

\begin{equation}
\label{kadai2}
	\int_0^\frac{\pi}{2} \sin x dx
\end{equation}

\subsection{作成したプログラム}
今回作成したプログラムをソースコード\ref{prog2}に示す。

\lstinputlisting[caption=課題2のプログラム,label=prog2]{src/kadai2.c}

%%%%%%%%%%%%%%%%%%%%%%%%プログラムの説明
このプログラムでは、{\tt float}型と{\tt double}型でシンプソンの公式を実行する。そして、（計算結果ー真値）の絶対値を表示している。なお、式\ref{kadai2}の真値は$1.0$である。また、刻み幅Nは1から512まで計算している。

\subsection{プログラムの実行結果}
実行結果を以下に示す。
\begin{oframed}
\verbatimtabinput[2]{result/kadai2.txt}
\end{oframed}

%%%%%%%%%%%結果解説

\subsection{考察}

\section{課題3,4,5}
課題3では、オイラー法を用いて式\ref{kadai345}の微分方程式を解く。そして、解析解と数値解を同じグラフにプロットし、オイラー法がどの程度正しいかを報告する。

課題4では、課題3をホイン法を用いて同様に行う。また、誤差の特徴についても同様に調べる。

課題5では、課題3をルンゲクッタ法を用いて同様に行う。また、誤差の特徴についても同様に調べる。

\begin{equation}
\label{kadai345}
	\frac{du}{dt} = u （ただし、t=0のときu=1）
\end{equation}

\subsection{作成したプログラム}
今回作成したプログラムをソースコード\ref{prog345}に示す。

\lstinputlisting[caption=課題3、4、5のプログラム,label=prog345]{src/kadai345.c}

%%%%%%%%%%プログラムの説明

\subsection{プログラムの実行結果}
実行結果を以下に示す。なお、出力される数値データが多いため、異なる刻み幅のときの同じ$t$の値のみを示している。
\begin{oframed}
\verbatimtabinput[2]{result/kadai345.txt}
\end{oframed}

%%%%%%%%%%%結果解説

\subsection{考察}

\end{document}